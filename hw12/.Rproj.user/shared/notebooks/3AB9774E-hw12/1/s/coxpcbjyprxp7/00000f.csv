"0","knitr::opts_chunk$set(echo = TRUE)"
"0","set.seed(123) "
"0",""
"0","# Simulating Data and Applying the χ²-Test"
"0",""
"0","# Parameters"
"0","lambda_h0 <- 2"
"0","sample_size <- 100"
"0","alpha <- 0.05"
"0",""
"0","# Simulating a sample under H0"
"0","sample_data <- rpois(sample_size, lambda_h0)"
"0",""
"0","# Observed frequencies"
"0","observed <- table(factor(sample_data, levels = 0:max(sample_data)))"
"0",""
"0","# Expected frequencies under H0"
"0","expected <- dpois(0:max(sample_data), lambda_h0) * sample_size"
"0",""
"0","# Chi-square test statistic"
"0","test_stat <- sum((observed - expected)^2 / expected)"
"0","test_stat"
"1","[1]"
"1"," 0.9983597"
"1","
"
"0","# Acceptance Region"
"0","# Degrees of freedom"
"0","df <- length(expected) - 1"
"0",""
"0","# Chi-square critical values"
"0","crit_lower <- qchisq(alpha / 2, df)"
"0","crit_upper <- qchisq(1 - alpha / 2, df)"
"0",""
"0","cat(""Acceptance region: ["", crit_lower, "", "", crit_upper, ""]\n"")"
"1","Acceptance region: ["
"1"," "
"1","1.237344"
"1"," "
"1",", "
"1"," "
"1","14.44938"
"1"," "
"1","]
"
"0","# Simulation under H0"
"0","num_simulations <- 1000"
"0","accept_null <- 0"
"0",""
"0","for (i in 1:num_simulations) {"
"0","  sample_data <- rpois(sample_size, lambda_h0)"
"0","  observed <- table(factor(sample_data, levels = 0:max(sample_data)))"
"0","  expected <- dpois(0:max(sample_data), lambda_h0) * sample_size"
"0","  test_stat <- sum((observed - expected)^2 / expected)"
"0","  "
"0","  if (crit_lower <= test_stat && test_stat <= crit_upper) {"
"0","    accept_null <- accept_null + 1"
"0","  }"
"0","}"
"0",""
"0","proportion_accept_null <- accept_null / num_simulations"
"0","proportion_accept_null"
"1","[1]"
"1"," 0.857"
"1","
"
"0","lambda_true <- 3"
"0","reject_null <- 0"
"0",""
"0","for (i in 1:num_simulations) {"
"0","  sample_data <- rpois(sample_size, lambda_true)"
"0","  observed <- table(factor(sample_data, levels = 0:max(sample_data)))"
"0","  expected <- dpois(0:max(sample_data), lambda_h0) * sample_size"
"0","  test_stat <- sum((observed - expected)^2 / expected)"
"0","  "
"0","  if (test_stat < crit_lower || test_stat > crit_upper) {"
"0","    reject_null <- reject_null + 1"
"0","  }"
"0","}"
"0",""
"0","strength_lambda_3 <- reject_null / num_simulations"
"0","strength_lambda_3"
"1","[1]"
"1"," 1"
"1","
"
"0","lambda_true <- 5"
"0","reject_null <- 0"
"0",""
"0","for (i in 1:num_simulations) {"
"0","  sample_data <- rpois(sample_size, lambda_true)"
"0","  observed <- table(factor(sample_data, levels = 0:max(sample_data)))"
"0","  expected <- dpois(0:max(sample_data), lambda_h0) * sample_size"
"0","  test_stat <- sum((observed - expected)^2 / expected)"
"0","  "
"0","  if (test_stat < crit_lower || test_stat > crit_upper) {"
"0","    reject_null <- reject_null + 1"
"0","  }"
"0","}"
"0",""
"0","strength_lambda_5 <- reject_null / num_simulations"
"0","strength_lambda_5"
"1","[1]"
"1"," 1"
"1","
"
